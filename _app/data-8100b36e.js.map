{"version":3,"file":"data-8100b36e.js","sources":["../../unoptimized/client/_app/components/data.js"],"sourcesContent":["import { writable } from \"../../web_modules/svelte/store.js\";\n\nconst defaultValue = [];\nconst delimiter = \"|\";\nconst filterColumns = [\"gender\", \"size\", \"season\", \"brand\"];\n\nconst arrayToObject = (array, headers) => {\n  const result = {};\n  for (let i = 0; i < array.length; i++) result[headers[i]] = array[i];\n  return result;\n};\n\nconst createBoty = () => {\n  const { subscribe, set } = writable(defaultValue);\n\n  const load = async ({ fetch }) => {\n    // check if we have data in store\n    const getData = () => new Promise(subscribe);\n    let boty = await getData();\n\n    // if not download, process, set to store\n    if (!boty || boty.length === 0) {\n      // const res = await fetch(`https://www.vyprodej-dovoz.cz/boty/produkty.csv`); \n      const res = await fetch(`/boty/boty.csv`);\n      const botyFile = await res.text();\n\n      const [headerLine, ...botyLines] = botyFile.split(/\\r?\\n/);\n      const headers = headerLine.split(\"|\").map((x) => x.trim());\n\n      boty = botyLines\n        .filter((x) => x)\n        .map((x) => x.split(delimiter).map((x) => x.trim()))\n        .map((x) => arrayToObject(x, headers));\n\n      set(boty);\n    }\n\n    // return back for SSR\n    return boty;\n  };\n\n  return {\n    subscribe,\n    reset: () => set(defaultValue),\n    load,\n    set,\n  };\n};\n\nexport const boty = createBoty();\n"],"names":["defaultValue","boty","subscribe","set","writable","reset","load","async","fetch","Promise","length","res","botyFile","text","headerLine","botyLines","split","headers","map","x","trim","filter","array","result","i","arrayToObject","createBoty"],"mappings":"6CAEA,MAAMA,EAAe,GA+CRC,EArCM,MACjB,MAAMC,UAAEA,EAASC,IAAEA,GAAQC,EAASJ,GA4BpC,MAAO,CACLE,UAAAA,EACAG,MAAO,IAAMF,EAAIH,GACjBM,KA7BWC,OAASC,MAAAA,MAGpB,IAAIP,QADkB,IAAIQ,QAAQP,GAIlC,IAAKD,GAAwB,IAAhBA,EAAKS,OAAc,CAE9B,MAAMC,QAAYH,EAAM,kBAClBI,QAAiBD,EAAIE,QAEpBC,KAAeC,GAAaH,EAASI,MAAM,SAC5CC,EAAUH,EAAWE,MAAM,KAAKE,KAAKC,GAAMA,EAAEC,SAEnDnB,EAAOc,EACJM,QAAQF,GAAMA,IACdD,KAAKC,GAAMA,EAAEH,MA5BJ,KA4BqBE,KAAKC,GAAMA,EAAEC,WAC3CF,KAAKC,GA1BQ,EAACG,EAAOL,KAC5B,MAAMM,EAAS,GACf,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAMZ,OAAQc,IAAKD,EAAON,EAAQO,IAAMF,EAAME,GAClE,OAAOD,GAuBWE,CAAcN,EAAGF,KAE/Bd,EAAIF,GAIN,OAAOA,GAOPE,IAAAA,IAIgBuB"}